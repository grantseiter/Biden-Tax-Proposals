// ===========================================================#
// Title: "CG_death-rec"
// File_Author: "Grant M. Seiter -- American Enterprise Institute"
// Date: "September 2020"
// Notes: "Tax unrealized capital gains at death"
          "Input Variables: taxable_gains_at_death, gains_at_death"
          "records_variables lines 651-662"
          "records lines 343-360"
// ===========================================================#

// records_variables.json

"taxable_gains_at_death": {
  "type": "float",
  "desc": "Imputed taxable portion of capital gains at death",
  "form": {"2021-20??": "imputed from JCT estimates in records.py"},
  "availability": "taxdata_puf"
},
"gains_at_death": {
  "type": "float",
  "desc": "Imputed capital gains at death",
  "form": {"2021-20??": "imputed from JCT estimates in records.py"},
  "availability": "taxdata_puf"
}

// records.py
# CAPITAL GAINS AT DEATH
if year >= 2021:
    # TAXPAYERS' SHARE OF CAPITAL GAINS
    self.ltgains_wt = ((self.p23250 * self.s006) / ## CHECK THIS LINE FOR DEBUGGING
                           np.sum(self.p23250 * self.s006))
    self.ltgains_wt[self.p23250 > 0] = (
        (self.p23250[self.p23250 > 0] * self.s006[self.p23250 > 0])
        / np.sum(self.p23250[self.p23250 > 0] *
                 self.s006[self.p23250 > 0]))
    # ASSIGN TOTAL REALIZATION AT DEATH TO TAXPAYERS
    # NOTE: VALUES ARE JCT CAP GAINS TAX EXPENDITURES FOR EXCLUSION AT DEATH/EMT
    realization_at_death = {
        2021: 204253570343, 2022: 215627184994,
        2023: 226688939254, 2024: 235220544654,
        2025: 243736672365, 2026: 245533163473,
        2027: 254865207631, 2028: 264380671657,
        2029: 274178230759, 2030: 284077457991}
    self.gains_at_death = ((
        self.ltgains_wt * realization_at_death[year]) /
                           (self.s006))
